asyncapi: 2.2.0
info:
  title: Discord Clone Websocket API
  version: 1.0.0
  description: >
    Discord Clone websocket API


    You can quickly play with the API using
    [websocat](https://github.com/vi/websocat#installation) like this:

    ```bash

    websocat ws://localhost:3001/v1/channels/{id}

    ```
servers:
  public:
    url: ws://localhost:3001
    protocol: ws
channels:
  /v1/chat:
    publish:
      description: Send messages to the API
      message:
        oneOf:
          - $ref: '#/components/messages/send-channel-message'
          - $ref: '#/components/messages/send-private-message'
    subscribe:
      description: Messages that you receive from the API
      message:
        oneOf:
          - $ref: '#/components/messages/update-channel-message'
          - $ref: '#/components/messages/update-private-message'
components:
  messages:
    send-channel-message:
      payload:
        $ref: '#/components/schemas/ChannelMessage'
    send-private-message:
      payload:
        $ref: '#/components/schemas/PrivateMessage'
    update-channel-message:
      payload:
        $ref: '#/components/schemas/ChannelMessage'
    update-private-message:
      payload:
        $ref: '#/components/schemas/PrivateMessage'
  schemas:
    ChannelMessage:
      title: ChannelMessage
      type: object
      properties:
        server:
          $ref: '#/components/schemas/Server'
        channel:
          $ref: '#/components/schemas/Channel'
        from:
          $ref: '#/components/schemas/User'
        content:
          type: string
        sended_at:
          type: string
          format: date-time
      required:
        - server
        - channel
        - from
        - content
      examples:
        - server:
            id: 26
            name: 42Tokyo
          channel:
            id: 1
            name: general
          from:
            id: 1
            name: tkomatsu
          content: hello world
    PrivateMessage:
      title: Private Message
      type: object
      description: ''
      properties:
        to:
          $ref: '#/components/schemas/User'
        from:
          $ref: '#/components/schemas/User'
        content:
          type: string
        sended_at:
          type: string
          format: date-time
      required:
        - to
        - from
        - content
      examples:
        - to:
            id: 2
            name: syudai
          from:
            id: 1
            name: tkomatsu
          content: hello world
    User:
      title: User
      type: object
      description: Discord clone user entity
      properties:
        id:
          type: integer
          description: Unique identifier for the given user.
        name:
          type: string
          description: Username
      required:
        - id
        - name
      examples:
        - id: 1
          name: tkomatsu
          email: tkomatsu@student.42tokyo.jp
        - id: 2
          name: syudai
          email: syudai@student.42tokyo.jp
    Server:
      title: Server
      type: object
      description: Server entity
      properties:
        id:
          type: integer
        name:
          type: string
      required:
        - id
        - name
      examples:
        - id: 26
          name: 42Tokyo
        - id: 27
          name: times
    Channel:
      title: Channel
      type: object
      description: Channel entity
      properties:
        id:
          type: integer
        name:
          type: string
      required:
        - id
        - name
      examples:
        - id: 1
          name: general
        - id: 2
          name: randome
